2025-10-26 22:04:47 [INFO] ==============================================
2025-10-26 22:04:47 [INFO]    VPN Listening Service Startup (PowerShell)
2025-10-26 22:04:47 [INFO] ==============================================
2025-10-26 22:04:47 [INFO] Logs saved at: C:\Users\Administrator\Desktop\Operations\System Core\Logs\Listening Service\ListeningService_2025-10-26_22-04-47.log
2025-10-26 22:04:47 [INFO] Reading config: C:\Users\Administrator\Desktop\Operations\System Core\Device Configuration\DeviceConfig.config
2025-10-26 22:04:47 [INFO] Loaded port: 5100
2025-10-26 22:04:47 [INFO] Listening on port 5100...
2025-10-26 22:25:01 [INFO] ================= NEW REQUEST =================
2025-10-26 22:25:01 [INFO] Path: /assign-ip
2025-10-26 22:25:01 [DEBUG] Body: {"publicKey":"5o9gmif3vK4YaztaOCfCwjFn5ksojDgf6J5jj7OwQxE="}
2025-10-26 22:25:01 [INFO] PublicKey: 5o9gmif3vK4YaztaOCfCwjFn5ksojDgf6J5jj7OwQxE=
2025-10-26 22:25:01 [STEP] Running assign_ip.ps1...
2025-10-26 22:25:08 [DEBUG] assign_ip.ps1 output:
2025-10-26 22:25:05 ================ ASSIGN_IP START ================ 2025-10-26 22:25:05 [STEP 1] Received public key: 5o9gmif3vK4YaztaOCfCwjFn5ksojDgf6J5jj7OwQxE= 2025-10-26 22:25:05 [STEP 2] Active WG interface detected: Tunnel-antiarin Tunnel-transact Tunnel-livre 2025-10-26 22:25:05 [DEBUG] wg show output:  Exception calling "Match" with "3" argument(s): "Value cannot be null. Parameter name: input" At C:\Users\Administrator\Desktop\Operations\Setup\Services\Listening\assign_ip.ps1:60 char:1 + $portMatch = [regex]::Match($info, "listening port:\s*(\d+)", 'Ignore ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~     + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException     + FullyQualifiedErrorId : ArgumentNullException   Exception calling "Match" with "3" argument(s): "Value cannot be null. Parameter name: input" At C:\Users\Administrator\Desktop\Operations\Setup\Services\Listening\assign_ip.ps1:61 char:1 + $keyMatch  = [regex]::Match($info, "public key:\s*([A-Za-z0-9+/=]+)", ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~     + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException     + FullyQualifiedErrorId : ArgumentNullException   2025-10-26 22:25:05 [INFO] Listen port: 51820 2025-10-26 22:25:05 [INFO] Server public key: unknown 2025-10-26 22:25:07 [WARN] No IP found on interface; fallback to 10.0.0 Exception calling "Matches" with "3" argument(s): "Value cannot be null. Parameter name: input" At C:\Users\Administrator\Desktop\Operations\Setup\Services\Listening\assign_ip.ps1:95 char:1 + $ipMatches = [regex]::Matches($info, "allowed ips:\s*([\d\.]+)/32", ' ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~     + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException     + FullyQualifiedErrorId : ArgumentNullException   2025-10-26 22:25:07 [INFO] Existing peer IPs:  2025-10-26 22:25:07 [STEP 6] Generating unique IP... 2025-10-26 22:25:07 [INFO] Selected IP: 10.0.0.220 2025-10-26 22:25:07 [STEP 7] Adding peer to Tunnel-antiarin Tunnel-transact Tunnel-livre... 2025-10-26 22:25:08 [CMD-FAIL] Exit code: 1 2025-10-26 22:25:08 [STDERR] Invalid argument: Tunnel-transact  2025-10-26 22:25:08 [STEP 8] Final JSON result: {     "port":  51820,     "serverPublicKey":  "unknown",     "assignedIP":  "10.0.0.220" } 2025-10-26 22:25:08 ================ ASSIGN_IP END ================ {"port":51820,"serverPublicKey":"unknown","assignedIP":"10.0.0.220"}
2025-10-26 22:25:08 [INFO] Detected and extracted valid JSON from output.
2025-10-26 22:25:08 [OK] Responded to 
2025-10-26 22:25:23 [INFO] ================= NEW REQUEST =================
2025-10-26 22:25:23 [INFO] Path: /assign-ip
2025-10-26 22:25:23 [DEBUG] Body: {"publicKey":"5o9gmif3vK4YaztaOCfCwjFn5ksojDgf6J5jj7OwQxE="}
2025-10-26 22:25:23 [INFO] PublicKey: 5o9gmif3vK4YaztaOCfCwjFn5ksojDgf6J5jj7OwQxE=
2025-10-26 22:25:23 [STEP] Running assign_ip.ps1...
2025-10-26 22:25:30 [DEBUG] assign_ip.ps1 output:
2025-10-26 22:25:27 ================ ASSIGN_IP START ================ 2025-10-26 22:25:27 [STEP 1] Received public key: 5o9gmif3vK4YaztaOCfCwjFn5ksojDgf6J5jj7OwQxE= 2025-10-26 22:25:27 [STEP 2] Active WG interface detected: Tunnel-antiarin Tunnel-transact Tunnel-livre 2025-10-26 22:25:27 [DEBUG] wg show output:  Exception calling "Match" with "3" argument(s): "Value cannot be null. Parameter name: input" At C:\Users\Administrator\Desktop\Operations\Setup\Services\Listening\assign_ip.ps1:60 char:1 + $portMatch = [regex]::Match($info, "listening port:\s*(\d+)", 'Ignore ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~     + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException     + FullyQualifiedErrorId : ArgumentNullException   Exception calling "Match" with "3" argument(s): "Value cannot be null. Parameter name: input" At C:\Users\Administrator\Desktop\Operations\Setup\Services\Listening\assign_ip.ps1:61 char:1 + $keyMatch  = [regex]::Match($info, "public key:\s*([A-Za-z0-9+/=]+)", ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~     + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException     + FullyQualifiedErrorId : ArgumentNullException   2025-10-26 22:25:27 [INFO] Listen port: 51820 2025-10-26 22:25:27 [INFO] Server public key: unknown 2025-10-26 22:25:28 [WARN] No IP found on interface; fallback to 10.0.0 Exception calling "Matches" with "3" argument(s): "Value cannot be null. Parameter name: input" At C:\Users\Administrator\Desktop\Operations\Setup\Services\Listening\assign_ip.ps1:95 char:1 + $ipMatches = [regex]::Matches($info, "allowed ips:\s*([\d\.]+)/32", ' ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~     + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException     + FullyQualifiedErrorId : ArgumentNullException   2025-10-26 22:25:29 [INFO] Existing peer IPs:  2025-10-26 22:25:29 [STEP 6] Generating unique IP... 2025-10-26 22:25:29 [INFO] Selected IP: 10.0.0.87 2025-10-26 22:25:29 [STEP 7] Adding peer to Tunnel-antiarin Tunnel-transact Tunnel-livre... 2025-10-26 22:25:30 [CMD-FAIL] Exit code: 1 2025-10-26 22:25:30 [STDERR] Invalid argument: Tunnel-transact  2025-10-26 22:25:30 [STEP 8] Final JSON result: {     "port":  51820,     "serverPublicKey":  "unknown",     "assignedIP":  "10.0.0.87" } 2025-10-26 22:25:30 ================ ASSIGN_IP END ================ {"port":51820,"serverPublicKey":"unknown","assignedIP":"10.0.0.87"}
2025-10-26 22:25:30 [INFO] Detected and extracted valid JSON from output.
2025-10-26 22:25:30 [OK] Responded to 
2025-10-26 22:26:17 [INFO] ================= NEW REQUEST =================
2025-10-26 22:26:17 [INFO] Path: /assign-ip
2025-10-26 22:26:17 [DEBUG] Body: {"publicKey":"5o9gmif3vK4YaztaOCfCwjFn5ksojDgf6J5jj7OwQxE="}
2025-10-26 22:26:17 [INFO] PublicKey: 5o9gmif3vK4YaztaOCfCwjFn5ksojDgf6J5jj7OwQxE=
2025-10-26 22:26:17 [STEP] Running assign_ip.ps1...
2025-10-26 22:26:25 [DEBUG] assign_ip.ps1 output:
2025-10-26 22:26:21 ================ ASSIGN_IP START ================ 2025-10-26 22:26:22 [STEP 1] Received public key: 5o9gmif3vK4YaztaOCfCwjFn5ksojDgf6J5jj7OwQxE= 2025-10-26 22:26:22 [STEP 2] Active WG interface detected: Tunnel-antiarin 2025-10-26 22:26:22 [DEBUG] wg show output: interface: Tunnel-antiarin   public key: dT9+o/fNm5+pNPqiB1gczlnjRuRwNldVDW1SEBPeljs=   private key: (hidden)   listening port: 51821 2025-10-26 22:26:22 [INFO] Listen port: 51821 2025-10-26 22:26:22 [INFO] Server public key: dT9+o/fNm5+pNPqiB1gczlnjRuRwNldVDW1SEBPeljs= 2025-10-26 22:26:24 [INFO] Detected base subnet from Tunnel-antiarin: 10.1.0 2025-10-26 22:26:24 [INFO] Existing peer IPs:  2025-10-26 22:26:24 [STEP 6] Generating unique IP... 2025-10-26 22:26:24 [INFO] Selected IP: 10.1.0.243 2025-10-26 22:26:24 [STEP 7] Adding peer to Tunnel-antiarin... 2025-10-26 22:26:25 [CMD-OK] Peer added successfully 2025-10-26 22:26:25 [STEP 8] Final JSON result: {     "port":  51821,     "serverPublicKey":  "dT9+o/fNm5+pNPqiB1gczlnjRuRwNldVDW1SEBPeljs=",     "assignedIP":  "10.1.0.243" } 2025-10-26 22:26:25 ================ ASSIGN_IP END ================ {"port":51821,"serverPublicKey":"dT9+o/fNm5+pNPqiB1gczlnjRuRwNldVDW1SEBPeljs=","assignedIP":"10.1.0.243"}
2025-10-26 22:26:25 [INFO] Detected and extracted valid JSON from output.
2025-10-26 22:26:25 [OK] Responded to 
